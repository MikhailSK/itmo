## Задания 34-50

### 34. Последовательность задана рекуррентным соотношением $a_0=a_1=1$, $a_n = 6a_{n-1}-8a_{n-2}$. Оцените асимптотическое поведение $a_n$ при $n\to+\infty$.

$$Q(t) = 1 - 6t + 8t^2 \leftrightarrow \frac{-3 \pm \sqrt{17}}{8}$$
$$r_\text{max} = 4 \quad f_\text{max} = 1$$
$$a_n \sim n^0 (4)^n = 4^n$$

### 35. Последовательность задана рекуррентным соотношением $a_0=a_1=1$, $a_n = 6a_{n-2}-a_{n-1}$. Оцените асимптотическое поведение $a_n$ при $n\to+\infty$.

$$Q(t) = 1 + t - 6t^2$$
$$r_\text{max} = 3 \quad f_\text{max} = 1$$
$$a_n \sim n^0 3^n$$

### 36. Последовательность задана рекуррентным соотношением $a_0=a_1=1$, $a_n = 6a_{n-1}-9a_{n-2}$. Оцените асимптотическое поведение $a_n$ при $n\to+\infty$.

$$Q(t) = 1 - 6t + 9t^2$$
$$r_\text{max} = 3 \quad f_\text{max} = 2$$
$$a_n \sim n \cdot 3^n$$

### 37. Последовательность задана рекуррентным соотношением $a_0=a_1=1$, $a_n = 2a_{n-1}-2a_{n-2}$. Оцените асимптотическое поведение $a_n$ при $n\to+\infty$.

$$Q(t) = 1 - 2t + 2t^2$$
$$r_1 = \frac{2}{1 - i} \quad r_2 = \frac{2}{1 + i}$$
$$a_n \sim \frac{1}{\sqrt 2^n} (e^{in\pi / 4} + e^{-in\pi / 4})$$

### 38. Пусть рациональная производящая функция имеет вид $A(s) = \frac {P(s)}{Q(s)}$, где единственный минимальный по модулю корень $Q(s)$ равен $1 / \beta$ и имеет кратность $k$. Тогда $a_n \approx C \beta^k n^{k-1}$. Покажите, что $C = k \frac {(-\beta)^n P(1 / \beta)} {Q^{(k)}(1 / \beta)}$

<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>

### 39. Докажите, что если последовательность $a_n$ допускает представление в виде $a_n = \sum_i p_i(n)q_i^n$, где $p_i(n)$ - полиномы, и все $q_i$ различны, то такое представление единственно с точностью до порядка слагаемых.

Пусть это не так. Тогда $a_n = \sum_i p_i(n) q_i^n = \sum_i \tilde p_i(n) \tilde q_i^n$.
$$0 = a_n - a_n = \sum_i p_i(n) q_i^n - \sum_i \tilde p_i(n) \tilde q_i^n$$
В силу ЛНЗ квазиполиномов с различными $q_i$ выполнено следующее: $p_iq_i$ есть перестановка $\tilde p_i \tilde q_i$

<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>

### 40. Из производящей функции чисел Каталана $C(t) = \frac {1 - \sqrt{1-4t}} {2t}$ покажите, что $C_n = \frac {1}{n+1} {2n \choose n}$. 

См. вики.

### 41. Путь Моцкина - путь, начинающийся в точке $(0, 0)$, составленный из векторов $(1, 1)$, $(1, 0)$, $(1, -1)$, не опускающийся ниже оси $OX$ и заканчивающийся в точке $(n, 0)$. Напишите рекуррентное соотношение для числа путей Моцкина, найдите производящую функцию для числа таких путей. Указание: в этом и нескольких следующих заданиях напишите рекуррентное соотношение, похожее на соотношение для чисел Каталана.

Рассмотрим путь, кончающийся в $(n, 0)$. В эту точку он пришел либо из $(n-1, 0)$, либо из $(n-1, 1)$. Число путей до $(n-1, 1)$ можно найти следующим образом: рассмотрим последнюю точку $(i, 0)$ такого пути. Число путей до $(i, 0)$ есть $M_i$. Число путей $(i, 0) \to (n-1, 1)$ есть $M_{n-i-2}$, т.к. первый шаг такого пути обязан быть вверх и дальше длина пути $n-2-i$. Итого:
$$M_n = M_{n-1} + \sum_{i=0}^{n-2} M_{i}M_{n-i-2}$$
$$M(t) = M(t)\cdot t + 1 + M(t) \cdot M(t) \cdot t^2$$
$$M^2(t) t^2 + M(t)(t-1) + 1 = 0$$
$$M(t) = \frac{1-t \pm \sqrt{t^2 - 2t + 1 - 4t^2}}{2t^2}$$
$$M(t) = \frac{1-t - \sqrt{1 - 2t - 4t^2}}{2t^2}$$

### 42. Рассмотрим множество путей на прямой, начинающихся в 0, состоящих из шагов длины 1 вправо или влево. Будем называть такой путь блужданием. Найдите рекуррентную формулу и производящую функцию для числа блужданий из $n$ шагов, оканчивающихся в 0.

$$\begin{cases}
    \binom{n}{n/2} = C_{n / 2} (n/2+1), & n\equiv 0 \mod 2\\
    0, & n\equiv 1 \mod 2
\end{cases}$$
$$\begin{aligned}
    a_n & = C_{n / 2} (n / 2 + 1) \\
    & = (n / 2 + 1) \sum_{i=0}^{n/2 - 1} C_{i} C_{n/2 - 1 - i} \\
    & = (n / 2 + 1) \sum_{i=0}^{n/2 - 1} \frac{a_i}{2i+1} \frac{a_{n/2 - 1 - i}}{n - 1 - 2i} \\
\end{aligned}$$

Несложно заметить, что бином $\binom{2n}{n}$ генерится функцией $\cfrac{1}{\sqrt{1-4t}}$ аналогично тому, что было на лекции. Можем её разжать, как в задаче 14:
$$\frac{1}{\sqrt{1-4t^2}}$$

### 43. Найдите рекуррентную формулу и производящую функцию для числа блужданий из $n$ шагов, оканчивающихся в фиксированной точке $N > 0$.


### 44. Найдите рекуррентную формулу и производящую функцию для числа блужданий из $n$ шагов, оканчивающихся в фиксированной точке $N > 0$ и не заходящих в отрицательную полупрямую.


### 45. Произведением Адамара двух производящих функций $A(t)$ и $B(t)$ называется производящая функция для ряда $C(t) = a_0b_0+a_1b_1t+a_2b_2t^2+\ldots+a_nb_nt^n+\ldots$. Докажите, что если $A(t)$ и $B(t)$ являются рациональными, то и $C(t)$ рациональна.

Квазимногочлены замкнуты по умножению.

### 46. Найдите произведение Адамара $\frac{1}{1-t}$ и $\frac{1}{1-2t}$.

$$\frac{1}{1-t} \leftrightarrow a_n = 1 \Rightarrow \frac{1}{1-t} \circ \frac{1}{1-2t} = \frac{1}{1-2t}$$


### 47. Найдите произведение Адамара $\frac{1}{1-2t}$ и $\frac{1}{1-3t}$.

$$\frac{1}{1-2t} \leftrightarrow a_n = 2^n$$
$$\frac{1}{1-3t} \leftrightarrow b_n = 3^n$$
$$c_n = a_n \cdot b_n = 6^n \leftrightarrow \frac{1}{1-6t}$$

### 48. Найдите произведение Адамара $\frac{1}{1+3t-t^2}$ и $\frac{1}{1-2t}$.

$$1+3t-t^2 \leftrightarrow \frac{3 \pm \sqrt{13}}{2}$$
$$r = \frac{2}{3 \pm \sqrt{13}} = -\frac{3\mp \sqrt{13}}{2}$$
$$a_n = p_1(n) \left(-\frac{3+\sqrt{13}}{2}\right)^n + p_2(n) \left(-\frac{3-\sqrt{13}}{2}\right)^n$$
Но $\deg p_1 = \deg p_2 = 0 \Rightarrow p_1 = C_1, p_2 = C_2$
$$a_n = C_1 \left(-\frac{3+\sqrt{13}}{2}\right)^n + C_2 \left(-\frac{3-\sqrt{13}}{2}\right)^n$$
$$c_n = C_1 (-3-\sqrt{13})^n + C_2 (-3+\sqrt{13})^n$$
$$\frac{-0.25}{(t + \frac{1}{3+\sqrt{13}})(t + \frac{1}{3-\sqrt{13}})}$$

### 49. Найдите произведение Адамара $\frac{1}{(1-3t)^2}$ и $\frac{1}{(1-2t)^2}$.

$$\frac{1}{(1-3t)^2} \leftrightarrow a_n = \sum_{i=0}^n 3^i 3^{n-i} = 3^n(n+1)$$
$$\frac{1}{(1-2t)^2} \leftrightarrow b_n = \sum_{i=0}^n 2^i 2^{n-i} = 2^n(n+1)$$
$$c_n = a_nb_n = 6^n(n+1)^2$$
$$Q(t) = (6t - 1)^3$$
$$q_0 = -1, q_1 = 18, q_2 = -108, q_3 = 216$$
$$c_0 = 1, c_1 = 24, c_2 = 324, c_3 = 3456, c_4 = 32400, c_5 = 279936$$
$$\begin{aligned}
    p_0 & = c_0 q_0 = 1\cdot (-1) = -1 \\
    p_1 & = c_0 q_1 + c_1 q_0 = 1 \cdot 18 + 24 \cdot (-1) = -6 \\
    p_2 & = c_0 q_2 + c_1 q_1 + c_2 q_0 = 1\cdot (-108) + 24 \cdot 18 + 324 \cdot (-1) = 0 \\
    p_3 & = c_0 q_3 + c_1 q_2 + c_2 q_1 + c_3 q_0 = 1 \cdot 216 + 24 \cdot (-108) + 324 \cdot 18 + 3456 \cdot (-1) = 0
\end{aligned}$$
$$\frac{-6t - 1}{(6t - 1)^3}$$

### 50. Найдите произведение Адамара $\frac{t}{1-3t+2t^2}$ и $\frac{2-4t}{1-4t+3t^2}$.

$$\frac{1}{1 - 3t + 2t^2} \leftrightarrow r_1 = 1, r_2 = 2$$
$$\frac{1}{1 - 3t + 2t^2} \leftrightarrow a_n = C_1 r_1^n + C_2 r_2^n = C_1 + C_2 2^n$$
$$\begin{cases}
    1 = a_0 = C_1 + C_2 \\
    3 = a_1 = C_1 + C_2 \cdot 2
\end{cases}$$
$$\begin{cases}
    -1 = C_1 \\
    2 = C_2
\end{cases}$$
$$\frac{t}{1 - 3t + 2t^2} \leftrightarrow \tilde a_n = a_{n-1} = -1 + 2^n$$

$$\frac{1}{1-4t+3t^2} \leftrightarrow r_1 = 1, r_2 = 3$$
$$\frac{1}{1-4t+3t^2} \leftrightarrow b_n = C_1 r_1^n + C_2 r_2^n = C_1 + C_2 3^n$$
$$\begin{cases}
    1 = b_0 = C_1 + C_2 \\
    4 = b_1 = C_1 + 3 C_2
\end{cases}$$
$$\begin{cases}
    1 - C_1 = C_2 \\
    1 = b_1 = -2C_1
\end{cases}$$
$$\begin{cases}
    C_2 = 1.5 \\
    C_1 = -0.5
\end{cases}$$
$$b_n = -0.5 + 1.5 \cdot 3^n$$
$$\frac{2-4t}{1-4t+3t^2} \leftrightarrow \tilde b_n = 2b_n - 4b_{n-1} = -1 + 3^{n+1} + 2 - 2 \cdot 3^{n} = 1 + 3^n$$
$$c_n = \tilde a_n \tilde b_n = (-1 + 2^n)(1 + 3^n) = 6^n + 2^n - 3^n - 1$$
$$Q(t) = (6t - 1)(3t - 1)(2t - 1)(t - 1)$$
$$Q(t) = 36t^4 - 72t^3 + 47t^2 - 12t + 1$$
$$c_0 = 0, c_1 = 4, c_2 = 30, c_3 = 196, c_4 = 1230, c_5 = 7564$$
$$\begin{aligned}
    p_0 & = c_0 q_0 = 0 \\
    p_1 & = c_1 q_0 = 4 \cdot 1 \\
    p_2 & = c_1 q_1 + c_2 q_0 = 4 \cdot (-12) + 30 \cdot 1 = -18 \\
    p_3 & = c_1 q_2 + c_2 q_1 + c_3 q_0 = 4 \cdot 47 + 30 \cdot (-12) + 196 \cdot 1 = 24 \\
    p_4 & = c_1 q_3 + c_2 q_2 + c_3 q_1 + c_4 q_0 = 4 \cdot (-72) + 30 \cdot 47 + 196 \cdot (-12) + 1230 \cdot 1 = -288 + 1410 - 2352 + 1230 = 0 \\
    p_5 & = c_1 q_4 + c_2 q_3 + c_3 q_2 + c_4 q_1 + c_5 q_0 = 4 \cdot 36 + 30 \cdot (-72) + 196 \cdot 47 + 1230 \cdot (-12) + 7564 \cdot 1 = -288 + 1410 - 2352 + 1230 = 0 \\
\end{aligned}$$
$$C(t) = \frac{4t - 18t^2 + 24t^3}{(t-1) (3t-1) (2t-1) (6t-1)}$$