## Задания 51-66

### 51. Найдите производящую функцию для последовательности гармонических чисел $H_n = 1+1/2+\ldots+1/n$.

Заметим, что $-\ln(1-x) \leftrightarrow \cfrac{1}{n}$, тогда $\cfrac{-\ln(1-x)}{1-x}$ есть искомое.

### 52. Пусть $g_n$ задано рекуррентным соотношением: $g_0=1$, для $n>0$ выполнено $g_n=g_{n-1}+2g_{n-2}+\ldots+ng_{0}$. Найдите явную формулу для $g_n$. Найдите производящую функцию для $g_n$.

$g(n) = F(2n)$, где $F(n)$ - $n$-тое число Фибоначчи.

База тривиальна

Переход:
$$\begin{aligned}
    F(2n) & = F(2n - 1) + F(2n - 2) \\
     & = 2F(2n - 2) + F(2n - 3) \\
     & = 2F(2n - 2) + F(2n - 4) + F(2n - 5) \\
     & = 2F(2n - 2) + \sum_{i=2}^n F(2n - 2i) \\
     & = F(2n - 2) + \sum_{i=1}^n F(2n - 2i) \\
     & = F(2n - 4) + \sum_{i=2}^n F(2n - 2i) + \sum_{i=1}^n F(2n - 2i) \\
     & = \sum_{j=1}^n \sum_{i=j}^n F(2n - 2i) \\
     & = \sum_{j=1}^n \sum_{i=j}^n g(n - i) \\
\end{aligned}$$

$$F(t) \leftrightarrow \frac{t}{1 - t - t^2}$$
$$F(2t) \leftrightarrow \frac{\frac{\sqrt t}{1 - \sqrt t - t} - \frac{\sqrt t}{1 + \sqrt t - t}}{2} = \frac{\sqrt t}{2} \frac{2 \sqrt t}{1 - 2t + t^2 - t} = \frac{t}{1 - 3t + t^2}$$

Но ещё +1.

Явная формула - $\frac{\varphi^{2n} + \left(-\frac{1}{\varphi}\right)^{2n}}{\sqrt 5}$, где $\varphi = \frac{1 + \sqrt 5}{2}$

### 53. Один эксцентричный коллекционер покрытий при помощи домино $2 \times n$-прямоугольника платит 4 доллара за каждую вертикально расположенную костяшку и 1 доллар — за горизонтальную. Сколько покрытий будут оценены по этому способу ровно в $n$ долларов? Найдите производящую функцию для числа таких покрытий.

Если $n$ из $2 \times n$ и $n$ долларов одинаковы, то ответ $\begin{cases}
    1, n \equiv 0 \mod 2 \\
    0, \text{иначе}
\end{cases}$. Это не слишком содержательно, поэтому предположим обратное.

$$a_n = a_{n - 4} + a_{n - 2}$$
Несложно заметить, что $a_n = F(n / 2 - 1)$

$$\frac{F(t^2)}{t^2} - 1 = \frac{1}{1 - t^2 - t^4} - 1 = \frac{t^4 + t^2}{1 - t^2 - t^4}$$

### 54. Найдите производящую функцию для замощений прямоугольника $2\times n$ доминошками и единичными клетками.

Пусть $A$ - производящая функция для замощений вида:
```
+--++----++----+      +----+
|  ||    ||    | .... |    | 
+--++----++----+      +----+
+----++----+      +----++--+
|    ||    | .... |    ||  | 
+----++----+      +----++--+
```

Несложно заметить, что такое замощение одно для любого $n$, кроме $n \le 1$, для него $0$, т.е. $A(t) = \frac{1}{1-t} - 1 - t$

$$S = 1 + tS + tS + t^2S + 2A$$
$$S = \frac{2t + 1 - \frac{2}{1 - t}}{t^2 + 2t - 1}$$
$$S = \frac{2t^2 - t + 1}{t^3 + t^2 - 3t + 1}$$

### 55. Найдите производящую функцию для замощений прямоугольника $2\times n$ уголками (квадратами $2\times 2$ с вырезанной одной клеткой) и единичными клетками. 

$$S = 1 + 4t^2S + 2t^3S + tS$$
$$S = \frac{-1}{2t^3 + 4t^2 + t - 1}$$
гда каждая из дробей генерит легко н

### 56. Найдите производящую функцию для замощений трехмерной колонны $2 \times 2 \times n$ кирпичами $2 \times 1\times 1$. 

$$A = 4\left(\frac{1}{1-t} - 1 - t\right)$$
$$S = 1 + 2tS + 5t^2S + A$$
$$S (5t^2 + 2t - 1) = -\frac{4}{1 - t} + 3 + 4t$$

### 57. Обозначим как $F_n$ число Фибоначчи с номером $n$ ($F_0 = 1$, $F_1 = 1$, $F_k = F_{k - 1} + F_{k - 2}$). Чему равна сумма $\sum_{\substack{m > 0, \, k_i > 0 \\ k_1+k_2+\ldots+k_m=n}} F_{k_1}F_{k_2}\cdots F_{k_m}?$

Производящая функция для этого есть композиция функции, генерящей $a_n = 1$ и $b_n = F_n$, т.е.
$$\frac{1}{1 - \frac{t}{1 - t - t^2}} = \frac{1 - t - t^2}{1 - 2t - t^2}$$

Можем заметить рекурсию $2a_{n-1}+a_{n-2}$, при этом $a_1=1, a_2=2$, т.е. это числа Пелла. Для них согласно вики есть формула $\cfrac{(1+\sqrt 2)^n - (1-\sqrt 2)^n}{2\sqrt 2}$

<!-- Найдём $a_n$. Раскроем эту дробь в сумму двух простых дробей $\cfrac{A}{t + 1 + \sqrt 2} + \cfrac{B}{t + 1 - \sqrt 2}$. Тогда каждая из дробей генерит легко находимые $b_n$ и $c_n$.

$$\frac{1 - t - t^2}{1 - 2t - t^2} = \frac{a + bt}{t + 1 + \sqrt 2} + \frac{c + dt}{t + 1 - \sqrt 2}$$
$$(a + bt)(t + 1 - \sqrt 2) + (c + dt) (t + 1 + \sqrt 2) = 1 - t - t^2$$
$$\begin{cases}
    b + d = -1 \\
    a + c + b(1 - \sqrt 2) + d(1 + \sqrt 2) = -1 \\
    a(1 - \sqrt 2) + c (1 + \sqrt 2) = 1
\end{cases}$$ -->

### 58. Неявное задание КО. (а) Пусть $A$, $B$ и $X$ - семейства комбинаторных объектов, причем $B \cap X = \varnothing$, $A = B \cup X$. Пусть производящие функции для $A$ и $B$ - $A(t)$ и $B(t)$, соответственно. Найдите производящую функцию $X(t)$. (б) Пусть $A$, $B$ и $X$ - семейства комбинаторных объектов, причем $A = B \times X$. Пусть производящие функции для $A$ и $B$ - $A(t)$ и $B(t)$, соответственно. Найдите производящую функцию $X(t)$. (в) Пусть $A$ и $X$ - семейства комбинаторных объектов, причем $A = Seq(X)$. Пусть производящая функция для $A$ - $A(t)$. Найдите производящую функцию $X(t)$.

a. $A(t) = B(t) + X(t) \Rightarrow X(t) = A(t) - B(t)$

b. $A(t) = B(t) \cdot X(t) \Rightarrow X(t) = \frac{A(t)}{B(t)}$ 

с. $A(t) = \frac{1}{1 - X(t)} \Rightarrow 1 - X(t) = \frac{1}{A(t)} \Rightarrow X(t) = 1 - \frac{1}{A(t)}$

### 59. Неявное задание КО 2. Пусть $A$ и $X$ - семейства комбинаторных объектов, причем $A = MSet(X)$. Пусть производящая функция для $A$ - $A(t)$. Докажите, что производящая функция для  $X(t)$ равна $\sum\limits_{k\ge 1}\frac{\mu(k)}{k}\log A(t^k)$, где $\mu$ - функция Мёбиуса.

$$\begin{aligned}
    A(t) & = \prod_{n=1}^{\infty} \left(\frac{1}{1-t^n}\right)^{x_n} \\
    \ln A(t) & = \ln \prod_{n=1}^{\infty} \left(\frac{1}{1-t^n}\right)^{x_n} \\
    \ln A(t) & = \sum_{n=1}^{\infty} \ln \left(\frac{1}{1-t^n}\right)^{x_n} \\
    \ln A(t) & = \sum_{n=1}^{\infty} -x_n \ln(1-t^n) \\
    \ln A(t) & = \sum_{n=1}^{\infty} -x_n \sum_{k=1}^{\infty} \frac{(-1)^{k-1}(-t)^{nk}}{k} \\
    \ln A(t) & = \sum_{k=1}^{\infty} \frac{X(t^k)}{k} \\
\end{aligned}$$

Пусть $B(t) = \ln A(t)$. Найдём $b_n$.

$$\begin{aligned}
    b_n & = \sum_{k : n \equiv 0 \mod k} \frac{x_{n / k}}{k} \\
    b_n & = \sum_{k : n \equiv 0 \mod k} \frac{kx_k}{n} \\
    nb_n & = \sum_{k : n \equiv 0 \mod k} kx_k \\
\end{aligned}$$

Инверсия Мёбиуса:
$$g(n) = \sum_{k : n\equiv 0 \mod k} f(d) \Rightarrow f(n) = \sum_{k : n \equiv 0 \mod k} \mu(k) g\left(\frac{n}{k}\right)$$

Применим к $nb_n$ и $kx_k$ как функциям $\N \to \Z$
$$nx_n = \sum_{k : n\equiv 0 \mod k} \mu(k) \frac{n}{k} k b_{n/k}$$
$$x_n = \sum_{k : n\equiv 0 \mod k} \mu(k) b_{n/k}$$

Несложно заметить, что свернув сумму по делителям в сумму $B(t^k)$, аналогично предыдущему, мы получим искомое.

### 60. Пусть $A$ - семейство комбинаторных объектов. Пусть $M = MSet(A)$, а $P = Set(A)$. Докажите, что $M(t) = P(t)M(t^2)$.

Очевидно из комбинаторики - число способов взять мультисет веса $n$ есть сумма чисел способов взять $n-k$ различных элементов умножить на число способов взять $k / 2$ ещё элементов, потому что их мы берем двойками, четверками и тд.

### 61. Пусть $A$ - семейство комбинаторных объектов с производящей функцией $A(t)$. Пусть $\mathbb{N}$ - множество натуральных чисел, (вес числа $k$ равен $k$). Пусть $T \subset \mathbb{N}$, обозначим как $T(t)$ производящую функцию для множества $T$. Обозначим как $Seq_T(A)$ множество последовательностей элементов из $A$, где длина последовательности лежит в множестве $T$. Обозначим как $Z$ множество из одного элемента веса $1$. Обозначим как $C^T$ множество представлений в виде суммы, где порядок слагаемых важен и слагаемые выбраны из множества $T$. Осознайте, что $C^T = Seq(Seq_T(Z))$. Найдите производящую функцию для $C^T$.

$$Seq_T(Z) \leftrightarrow i\in T$$

$$Seq(Seq_T(Z)) \leftrightarrow \{i_j\}\in T$$

$$[n]Seq_T(Z) = \begin{cases}
    0, & n\not\in T \\
    1, & n\in T
\end{cases}$$

$$Seq(Seq_T(Z)) = \frac{1}{1 - \sum_{n\in T} t^n}$$

### 62. Докажите, что $\frac{1}{1-z}=\prod\limits_{j=0}^\infty(1+z^{2^j})$.

$\frac{1}{1-z} = \sum z^n$

Несложно заметить, что $\prod (1 + z^{2^j}) = \sum z^n$, потому переход в двоичную систему счисления биективен.

### 63. Обозначим за $B$ множество всех конечных подмножеств $A$, в которых все элементы имеют различный вес. Выведите производящую функцию $B(t)$.

Число искомых множеств веса $k$ есть сумма произведений всех количеств объектов $\in A$, таких что сумма их весов $k$:
$$b_k = \sum_{\{n_i\} : \sum n_i = k} \prod_i a_{n_i}$$
$$B(t) = \prod_{n=1}^{\infty} (1 + a_nz^n)$$

### 64. Определим множество "неориентированных последовательностей" $B = USeq(A)$, как множество всех последовательностей элементов из $A$, где последовательность $L$ и $rev(L)$ считаются одинаковыми. Покажите, что $B(t) = \frac 12 \frac {1}{1 - A(t)} + \frac 12 \frac {1 + A(t)}{1 - A(t^2)}$

Применим теорему Редфилда-Пойи _(на самом деле частный случай оной)_:
$$(Y^X / G)(t) = \frac{1}{|G|} Z_G(X(t^1), X(t^2), \dots)$$
, где $Y^X$ есть множество всех отображений $Y \to X$, а $Y^X / G$ есть то множество с точностью до действия группы $G$ и
$$Z_G(a_1 \dots a_n) = \frac{1}{|G|} \sum_{g\in G} \prod_{i = 1}^n a_i^{c_i(g)}$$
, где $c_i(g)$ - число циклов длины $i$ элемента группы $g$.

Пусть $Y = \N_n$ - множество первых $n$ натуральных чисел _(без 0)_, $X=A$, $G = \mathfrak{R}_m$ - группа, состоящая из тривиального действия и реверса последовательности, т.е. $G = \left\{\begin{pmatrix}
    1 \dots n \\
    1 \dots n
\end{pmatrix}\begin{pmatrix}
    1 \dots n \\
    n \dots 1
\end{pmatrix} \right\}$. Тогда $Y^X / G$ есть $USeq_n(A)$ - множество неориентированных последовательностей над $A$ длины $n$.

Несложно заметить, что $Z_{\mathfrak R_n}(a_1 \dots a_n) = \begin{cases} a_2^{n / 2} + a_1^n ,& n\equiv0\mod2 \\ a_1 a_2^{(n - 1) / 2} + a_1^n ,& n\equiv1\mod2 \end{cases}$, т.к. для тривиального действия $n$ циклов длины $1$ _(каждый элемент отображается в себя)_, а для реверса либо все циклы длины $2$, либо в центре есть отображение элемента в себя и тогда добавляется цикл длины $1$.

$$\begin{aligned}
    USeq_n(A)(t) & = \frac{1}{2} Z_{\mathfrak R_n}(A(t), A(t^2)) \\
     & = \frac{1}{2} \cdot \begin{cases} A(t^2)^{n / 2} + A(t)^n ,& n\equiv0\mod2 \\ A(t) A(t^2)^{(n - 1) / 2} + A(t)^n ,& n\equiv1\mod2 \end{cases} \\
    USeq(A)(t) & = \sum_{n=0}^{\infty} USeq_n(A)(t) \\
    & = \sum_{n=0}^{\infty} USeq_{2n}(A)(t) + \sum_{n=0}^{\infty} USeq_{2n+1}(A)(t) \\
    & = \frac{1}{2} \sum_{n=0}^{\infty} (A(t^2)^{n} + A(t)^{2n}) + \frac{1}{2} \sum_{n=0}^{\infty} (A(t) A(t^2)^n + A(t)^{2n+1}) \\
    & = \frac{1}{2} \sum_{n=0}^{\infty} (A(t^2)^{n}(1 + A(t))) + \frac{1}{2} \sum_{n=0}^{\infty} (A(t)^{2n} + A(t)^{2n+1}) \\
    & = \frac{1}{2} (1 + A(t)) \sum_{n=0}^{\infty} A(t^2)^{n} + \frac{1}{2} \sum_{n=0}^{\infty} A(t)^{n} \\
    & = \frac{1}{2} \frac{1 + A(t)}{1 - A(t^2)} + \frac{1}{2} \frac{1}{1 - A(t)} \\
\end{aligned}$$

### 65. Зафиксируем числа $k$ и $t$. Найдите производящую функцию для числа сочетаний из $n$ по $k$, где любые два выбранных числа отличаются как минимум на $t$. Исследуя ПФ, найдите количество таких сочетаний.

$$Seq(a)(b\ Seq_{\ge t}(a))^{k-1}b\ Seq(a)$$
$$Seq_{\ge t}(a) = \sum_{i=t}^{\infty} z^i = \frac{z^t}{1-z}$$
$$\frac{z^k z^{t(k-1)}}{(1-z)^{k+1}} = \frac{z^{kt + k - t}}{(1-z)^{k+1}}$$

Найдём коэффициент при $z^n$.

$$z^{kt + k - t} \cdot \sum_{i=0}^{\infty} \binom{k + 1 + i - 1}{i}x^i$$
$$z^{kt + k - t} \sum_{i=0}^{\infty} \binom{k + i}{i}x^i$$

$$kt + k - t + i = n \Rightarrow i = n - kt - k + t$$
$$\binom{k + n - kt - k + t}{n - kt - k + t} = \binom{n - kt + t}{n - kt - k + t} = \binom{n - kt + t}{k}$$

Мне лень.

### 66. Зафиксируем числа $k$ и $t$. Найдите производящую функцию для числа сочетаний из $n$ по $k$, где разница между любыми соседними выбранными числами не больше $t$. Исследуя ПФ, найдите количество таких сочетаний.

Зададим $\binom{n}{k}$ регуляркой: $a^* (ba^*)^k$ содержит $k$ букв $b$. То же самое комбинаторикой: $Seq(a) (b\ Seq(a))^k$

По аналогии искомое задается $Seq(a)(b\ Seq_{<t}(a))^{k-1}b\ Seq(a)$

$$\frac{z^k(1 - z^t)^{k-1}}{(1-z)^{k+1}}$$

Найдём коэффициент при $z^n$.

$$z^k\left(\sum_{j=0}^{k-1} (-1)^j \binom{k-1}{j} z^{tj}\right) \cdot \left(\sum_{i=0}^{\infty} \binom{k + 1 + i - 1}{i}x^i\right)$$
$$z^k\left(\sum_{j=0}^{k-1} (-1)^j \binom{k-1}{j} z^{tj}\right) \cdot \left(\sum_{i=0}^{\infty} \binom{k + i}{i}x^i\right)$$
$$tj + k + i = n \Rightarrow i = n - k - tj$$
$$\sum_j (-1)^j \binom{k-1}{j}\binom{k + i}{i}$$
$$\sum_j (-1)^j \binom{k-1}{j}\binom{n - tj}{n - k - tj}$$
$$\sum_j (-1)^j \binom{k-1}{j}\binom{n - tj}{k}$$