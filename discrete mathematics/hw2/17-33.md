# Задания 17-33, весна 2020

### 17. Найдите распределение и математическое ожидание следующей случайной величины: число бросков нечестной монеты до первого выпадения 1.

Распределение: $F_\xi(a)=P(\xi\leq a)$
$$P(\xi= a) = (1-p)^{a-1}p$$
$$P(\xi\leq a)=\sum\limits_{i=1}^a P(\xi = i)=\sum\limits_{i=1}^a (1-p)^{i-1}p=p\frac{1-(1-p)^a}{p}=1-(1-p)^a$$
$$E_\xi = \sum\limits_a a\cdot P(\xi = a)= \sum\limits_{j=1}^{\infty} P(\xi\geq j)= \sum\limits_{j=1}^{\infty} 1 - P(\xi< j)=\sum\limits_{j=1}^{\infty} 1 - P(\xi \leq j) + P(\xi = j) = \sum\limits_{j=1}^{\infty} 1 - 1 + (1-p)^j+(1-p)^{j-1}p =$$
$$=\sum\limits_{j=1}^\infty (1-p)^{j-1}(p+1-p)=\sum\limits_{j=1}^{\infty} (1-p)^{j-1}=\lim\limits_{n\to\infty}\sum\limits_{j=0}^{n} (1-p)^{j}=\lim\limits_{n\to\infty}\frac{1-(1-p)^n}{p}=\frac{1}{p}$$

### 18. Найдите распределение и математическое ожидание следующей случайной величины: число бросков честной монеты до второго выпадения 1

$$P(\xi = a) = p(1-p)^{a-2}p=p^2(1-p)^{a-2}=\left(\frac{1}{2}\right)^a$$
$$P(\xi \geq a) = \frac{1}{2^{a-2}}$$
$$P(\xi \leq a) = 1 - P(\xi > a) = 1 - P(\xi \geq a) + P(\xi = a) = 1 - \frac{1}{2^{a-2}}+\frac{1}{2^a}=1-\frac{3}{2^a}$$

$$E_\xi = \sum\limits_{j=1}^\infty P(\xi\geq j) = \sum\limits_{j=1}^\infty \frac{1}{2^{j-2}}=2+\sum\limits_{j=0}^\infty\frac{1}{2^{j}}=4$$

### 19. Найдите математическое ожидание числа инверсий в перестановке чисел от 1 до n

$\xi(\pi):=$число инверсий в $\pi$

$$\xi(\pi)=\sum\limits_{i=1}^{n-1}\sum\limits_{j=i+1}^{n} \xi_{ij}(\pi)$$
$$P(\xi_{ij}=1)=\frac{1}{2}$$
$$E_{\xi_{ij}}=1\frac{1}{2}+0\cdot\ldots=\frac{1}{2}$$
$$E_\xi = \sum\limits_{i=1}^{n-1}\sum\limits_{j=i+1}^{n} E_{\xi_{ij}}=\sum\limits_{i=1}^{n-1}\sum\limits_{j=i+1}^{n}\frac{1}{2}=\frac{n(n-1)}{4}$$

### 20. Найдите математическое ожидание числа подъемов в перестановке чисел от 1 до n

$\sphericalangle P$- перестановка

$\sphericalangle P'$- перестановка, обратная $P$

$\xi(P)+\xi(P')=n-1$, т.к. каждая послед. пара либо подъем в $P$, либо в $P'$. Таких пар $n-1$.

Все перестановки можно поделить на $\frac{n!}{2}$таких пар перестановок $\Rightarrow$
$$E_\xi=\frac{1}{n!}\sum\limits_{i=1}^{\frac{n!}{2}}\xi(P_i)+\xi(P_i')=\frac{1}{n!}(n-1)\frac{n!}{2}=\frac{n-1}{2}$$

### 21. Найдите математическое ожидание числа троек $i, j, k$, где $i<j<k$и $a[i]<a[j]<a[k]$ в перестановке чисел от 1 до n

$$\xi(\pi)=\sum_{i=1}^{n-2}\sum_{j=i+1}^{n-1}\sum_{k=j+1}^{n} \xi_{ijk}$$

$E_{\xi_{ijk}}=\frac{1}{6}$, т.к. только 1 из 6 перестановок $ijk$ удовлетворяют условию и эти перестановки равновероятны.

$$E_\xi=n(n-1)(n-2)\frac{1}{6}=C_n^3$$

### 22. Предложите метод генерации случайной перестановки порядка n с равновероятным распределением всех перестановок, если мы умеем генерировать равномерно распределенное целое число от 1 до k для любых небольших $k=O(n)$.

```c
int[n] randomPermutation(a: int[n]):   // n — длина перестановки 
    for i = n .. 1
        j = random(1..i)
        swap(a[i], a[j])
    return a
```

Доказательство: На каждой итерации цикла мы выбираем случайный элемент из всех оставшихся, то есть у нас есть $n$ способов выбрать $1$ элемент, $n - 1$ способов выбрать $2$ элемент... $1$ способ выбрать последний элемент. Ни на одной итерации нам не попадется ни один элемент, который уже был выбран ранее, ведь на каждом шаге выбираемые числа мы переносим в конец массива путём перестановки с последним невыбранным числом. Таким образом, последовательность длины $n$ мы можем получить  $n \times (n - 1) \times \ldots \times 1 = n!$способами, что совпадает с числом различных перестановок длины $n$. Это означает, что вероятность выбрать любую перестановку длины $n$ равна $\dfrac{1}{n!}$, то есть все перестановки равновероятны.

### 23. Дает ли следующий метод равномерную генерацию всех перестановок? "`p = [1, 2, ..., n]; for i from 1 to n: swap(p[i], p[random(1..n)])`"

Нет, т.к. есть $n^n$ число способов сгенерить последовательность, что не делится на $n!$.

### 24. Дает ли следующий метод равномерную генерацию всех перестановок? "`p = [1, 2, ..., n]; for i from 1 to n: swap(p[random(1..n)], p[random(1..n)])`"

Нет, т.к. есть $n^{2n}$ число способов сгенерить последовательность, что не делится на $n!$.

### 25. Предложите метод генерации случайного сочетания из n по k с равновероятным распределением всех сочетаний, если мы умеем генерировать равномерно распределенное целое число от 1 до t для любых небольших $t=O(n)$

k раз:

1. Выберем в множестве случайный элемент
2. Добавим его в сочетание
3. Удалим элемент из множества

### 26. Предложите метод генерации случайного сочетания из n по k с равновероятным распределением всех сочетаний, если мы умеем генерировать равномерно распределенное целое число от 1 до t для любых небольших $t=O(n)$, использующий $O(k)$ времени и памяти.

Рассмотрим массив a размера n, состоящий из k единиц и n−k нулей. Применим к нему алгоритм генерации случайной перестановки за линию. Тогда все элементы i, для которых a[i]=1, включим в сочетание. Всего перестановок $n!$, но т.к. есть повторения элементов, то на самом деле их $\frac{n!}{k!(n-k)!}$. Исходные перестановки равновероятны и каждой уникальной перестановке сопоставляется $(n-k)!k!$ перестановок $\Rightarrow$ уникальные перестановки тоже равновероятны. Кроме того, $\frac{n!}{k!(n-k)!}$ - число искомых сочетаний.

### 28. Постройте случайную величину, имеющую конечное математическое ожидание и бесконечную дисперсию.

$$\xi \in\{1,2\ldots\} \quad P(\xi = a)=\frac{c}{a^{2.5}} \quad c := \frac{1}{\sum_{n=1}^\infty\frac{1}{n^{2.5}}}$$
$$E_\xi = \sum\limits_{a}a\frac{c}{a^{2.5}}=\sum\limits_{a}\frac{c}{a^{1.5}}$$
Докажем сходимость $\sum\limits_a \frac{1}{a^{1.5}}$

По Cauchy condensation test:
$$\sum\limits_a \frac{1}{a^{1.5}}\not=\infty \Leftrightarrow \sum\limits_a 2^a\frac{1}{2^{1.5a}}\not=\infty$$
$$\sum\limits_a 2^a\frac{1}{2^{1.5a}}=\sum\limits_a \frac{1}{2^{0.5a}}=\sum\limits_a \frac{1}{\sqrt{2^{a}}}$$
По Ratio test:
$$\lim_{n\to+\infty}\left|\frac{i_{a+1}}{i_a}\right|=\lim_{n\to+\infty}\left|\frac{\sqrt{2^{a}}}{\sqrt{2^{a+1}}}\right|=\lim_{n\to+\infty}\frac{1}{\sqrt 2}=\frac{1}{\sqrt 2} < 1 \Rightarrow \not=\infty$$

Итого, $E_\xi$ конечно

$$Var(\xi)=E(\xi-E_\xi)^2=E_{\xi^2}-(E_\xi)^2$$

$(E_\xi)^2$ - конечно $\Rightarrow$ если $E_{\xi^2}$ бесконечно, то $Var(\xi)$ бесконечно

$$E_{\xi^2}=\sum_a a^2\frac{c}{a^{2.5}}=\sum_a \frac{c}{a^{0.5}} \geq \sum_a \frac{c}{a}=\infty$$

### 29. Постройте случайную величину, имеющую бесконечное математическое ожидание и конечную дисперсию.

Такое невозможно, т.к. (нирк) _Если дисперсия случайной величины конечна, то конечно и её математическое ожидание_

$Var(\xi)=E(\xi-E_\xi)^2$ - если $E_\xi=\infty$, то $\xi-E_\xi$ не определено $\Rightarrow$ дисперсия не определена в $\R$.

### 30. Рассмотрим игру. Колода из 52 карт, 26 красных и 26 черных, тасуется, так что все порядки следования карт оказываются равновероятными. Затем карты извлекаются по одной и колоды в открытую до того момента, пока не игрок не скажет "стоп". После этого открывается еще одна карта, если она красная, то игрок выигрывает. Какая стратегия максимизирует вероятность выигрыша игрока?

Матожидание всегда $\frac{1}{2}$, не выебывайся и стопь сразу или когда угодно, поебать.

### 31.

$$E\xi=\sum_{i=1}^5 E\xi_i=\sum_i 0.8^{10}=5\cdot 0.8^{10}$$

### 32.

$$5\cdot10\frac{1}{5}0.8^9$$

### 33. Докажите, что минимум $E(X−α)^2$ достигается при $α=EX$.

$$E(x-\alpha)^2=Ex^2+E\alpha^2-2E(\alpha x) = Ex^2+\alpha^2-2\alpha Ex$$
$$(Ex^2+\alpha^2-2\alpha Ex)'=2\alpha-2Ex$$
$$\alpha-Ex=0$$
$$\alpha=Ex$$
