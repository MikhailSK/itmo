## Задания 127-143

### 127. Найдите математическое ожидание степени вершины в биномиальной модели $G(n, p)$.

$$\mathbb P(d(v) = k) = \binom{n-1}{k}p^k (1-p)^{n-1-k}$$

Выбрали $k$ ребер, для них $p$, для остальных, инцидентных $v$, $1-p$.

### 128. Рассмотрим равномерную модель: $G(n, m)$, в которой случайный граф выбирается равновероятно из всех графов, содержащих $n$ вершин и $m$ ребер. Найдите вероятность, что граф в равномерной модели $G(n, m)$ является деревом ($m = n - 1$).

$$|G(n, m)| = \binom{m}{n(n-1)/2}$$

Из домашки:
$$|\mathcal T(K_n)| = n^{n-2}$$

$$\frac{n^{n-2}}{\binom{m}{n(n-1)/2}}$$

### 129. Найдите вероятность, что граф в биномиальной модели $G(n, p)$ является деревом.

$$\sum_T p^{n-1}(1-p)^{n(n-1)/2} = n^{n-2}p^{n-1}(1-p)^{n(n-1)/2}$$

### 130. Найдите вероятность, что граф в равномерной модели $G(n, m)$ является гамильтоновым циклом ($m = n$).

Гамильтонов цикл $\Leftrightarrow$ упорядочить все вершины, т.е. число гамильтоновых циклов = числу перестановок $n$ объектов = $n!$

$$\frac{n!}{\binom{m}{n(n-1)/2}}$$

### 131. Найдите вероятность, что граф в биномиальной модели $G(n, p)$ является гамильтоновым циклом.

$$\sum_C p^{n-1}(1-p)^{n(n-1)/2} = n!p^{n-1}(1-p)^{n(n-1)/2}$$


### 132. (для 34-35) Докажите, что если $p = o(\frac{1}{n^2})$, то случайный граф $G(n, p)$ а.п.н. не имеет ребер (а.п.н. = асимптотически почти наверное = с вероятностью, стремящейся к 1).


### 133. (для 34-35) Докажите, что если $p = \omega(\frac{1}{n^2})$, то случайный граф $G(n, p)$ а.п.н. имеет хотя бы одно ребро.


### 134. (для 34-35) Пусть $p = \frac{c}{n^2}$ для некоторого $c$. Найдите вероятность того, $G(n, p)$ имеет хотя бы одно ребро.


### 135. Оцените центральный биномиальный коэффициент ${2n \choose n}$ снизу величиной порядка $c\frac {4^n}{\sqrt{n}}$. Указание: используйте формулу Стирлинга.

<!-- ![](imgs/no_i_dont_think_i_will.jpg)

Докажем по индукции по $n$, что $\binom{2n}{n} \ge \frac{4^n}{2\sqrt n}$

База: $\binom{2}{1} = 2 = \frac{4}{2}$.

Переход:
$$\binom{2n+2}{n+1} = \frac{2(n+1)(2n+1)}{(n+1)^2}\binom{2n}{n} \ge \frac{2(2n+1)}{(n+1)} \frac{4^n}{2\sqrt n} \ge \frac{2(2n+1)}{(n+1)} \frac{4^n}{2\sqrt{n+1}} \ge \frac{1}{\sqrt{n+1}}$$ -->

$$\binom{2n}{n} \sim \frac{\sqrt{4\pi n}\left(\frac{2n}{e}\right)^{2n}}{2\pi n\left(\frac{n}{e}\right)^{2n}} = \frac{4^n}{\sqrt{\pi n}}$$

<!-- $$\binom{2n}{n} = \frac{(2n)^{2n} e^{-2n} \mathcal O(2n)}{n^{2n} e^{-2n} \mathcal O^2(n)} = \frac{2^{2n} n^{2n} \mathcal O(n)}{n^{2n} \mathcal O^2(n)} = \frac{2^{2n}}{\mathcal O(n)} \ge \frac{2^{2n}}{2^n} \ge \frac{1}{\sqrt n}$$ -->

### 136. Рассмотрим число ребер $m$, такое что $m(n) \to \infty$ и ${n \choose 2} - m(n) \to \infty$, а также $p(n) = \frac {m(n)}{n \choose 2}$. Докажите, что вероятность того, что $G(n, p)$ имеет ровно $m$ ребер есть $\Omega(m^{-0.5})$.

См. 137

### 137. Рассмотрим свойство $A$, а и такие же $m(n)$ и $p(n)$, как в предыдущей задаче. Докажите, что $\mathbb P(G(n, m) \in A) \le C \sqrt{m} \mathbb P(G(n, p) \in A)$.

$$\mathbb P(G(n, p) \in A) = \sum_{k=0}^{n(n-1)/2} \mathbb P(G(n, p) \in A\ |\ |E| = k) \mathbb P(|E| = k)$$
<!-- Упростим $\mathbb P(G(n, p) \in A\ |\ |E| = k)$, чтобы доказать -->
Тривиальный факт $\mathbb P(G(n, p) \in A\ |\ |E| = k) = \mathbb P(G(n, k) \in A)$
<!-- $$\begin{aligned}
    \mathbb P(G(n, p) \in A\ |\ |E| = k) & = \frac{\mathbb P(G(n, p) \in A \cup |E| = k)}{\mathbb P(|E| = k)} \\
    & = \frac{\sum\limits_{\substack{G : |V|=n}} \dfrac{[G(n, p) \in A][|E|=k] p^k(1-p)^{n(n-1)/2 - k}}{p^k(1-p)^{n(n-1)/2 - k}}}{\binom{n(n-1)/2}{k}} \\
    & = \frac{\sum\limits_{\substack{G : |E| = k \\ |V|=n}} \dfrac{[G(n, p) \in A] p^k(1-p)^{n(n-1)/2 - k}}{p^k(1-p)^{n(n-1)/2 - k}}}{\binom{n(n-1)/2}{k}} \\
    & = \frac{\sum\limits_{\substack{G : |E| = k \\ |V|=n \\ G\in A}} \dfrac{p^k(1-p)^{n(n-1)/2 - k}}{p^k(1-p)^{n(n-1)/2 - k}}}{\binom{n(n-1)/2}{k}} \\
    & = \sum\limits_{\substack{G : |E| = k \\ |V|=n \\ G\in A}}\frac{1}{\binom{n(n-1)/2}{k}} \\
    & = \mathbb P(G(n, k)\in A)
\end{aligned}$$ -->
Подставим в первую формулу:
$$\mathbb P(G(n, p) \in A) = \sum_{k=0}^{n(n-1)/2} \mathbb P(G(n, k)\in A) \mathbb P(|E| = k)$$
Упростим $\mathbb P(|E| = k)$
$$\begin{aligned}
    \mathbb P(|E| = k) & = \binom{n(n-1)/2}{k} p^k(1-p)^{n(n-1)/2 - k} \\
    & = \frac{(n(n-1)/2)!}{k!(n(n-1)/2 - k)!} p^k(1-p)^{n(n-1)/2 - k} \\
    & = \frac{t!}{k!(t - k)!} p^k(1-p)^{t - k} \\
    & = \frac{\sqrt{2\pi t}\left(\frac{t}{e}\right)^t\exp(12 t + \Theta)^{-1}}{\sqrt{2\pi k}\left(\frac{k}{e}\right)^k\exp(12 k + \Theta)^{-1}\sqrt{2\pi (t - k)}\left(\frac{t - k}{e}\right)^{t-k}\exp(12 (t - k) + \Theta)^{-1}} p^k(1-p)^{t - k} \\
    & = \frac{\sqrt{t}t^t\exp(12 t + \Theta)}{\sqrt{2\pi k}k^k\sqrt{t - k}(t-k)^{t-k}\exp(12 t + \Theta)} p^k(1-p)^{t - k} \\
    & \ge \frac{t^t\exp(12 t + \Theta)}{\sqrt{2\pi k}k^kt^{t-k}\exp(12 t + \Theta)} \\
    & \ge \frac{Ct^k}{\sqrt{2\pi k}t^k} \\
    & \ge \frac{C}{\sqrt k} \\
\end{aligned}$$
$$\mathbb P(G(n, p) \in A) \ge \sum_{k=0}^{n(n-1)/2} \mathbb P(G(n, k)\in A) \frac{C}{\sqrt k}$$
$$\mathbb P(G(n, p) \in A) \ge \mathbb P(G(n, m)\in A) \frac{C}{\sqrt m}$$

### 138. Рассмотрим следующую модель генерации случайного графа. Сначала проведем каждое ребро с вероятностью $\frac 12$. Затем, для каждой пары вершин, между которыми не было проведено ребро на первом шаге, проведем ребро с вероятностью $\frac 13$. Предложите более простое описание этой модели в терминах моделей Эрдёша-Реньи.

$\mathbb P(uv) = \mathbb P(\text{первый шаг}) + \mathbb P(\text{второй шаг}) - \mathbb P(\text{первый шаг} \cap \text{второй шаг}) = \mathbb P(\text{первый шаг}) + \mathbb P(\text{второй шаг}) = \frac{1}{2} + \frac{1}{2}\frac{1}{3} = \frac{2}{3}$

### 139. Свойство случайного графа называется, монотонным, если оно сохраняется при добавлении ребра. Рассмотрим монотонное свойство $A$ при фиксированном размере графа $n$. Докажите, что $\mathbb P(G(n, p) \in A)$ возрастает при возрастании $p$.

Рассмотрим $p_1 < p_2$. Докажем, что $\mathbb P(G(n, p_1) \in A) \le \mathbb P(G(n, p_2))$.

Пусть $p_0 = \frac{p_2 - p_1}{1 - p_1}$, т.е. $p_1 + (1 - p_1) p_0 = p_2$. Тогда $G(n, p_2) = G(n, p_1) \cup G(n, p_0)$, т.е. можно построить $G(n, p_2)$ в два шага: через $p_0$ и $p_1$. $\Rightarrow \mathbb P(G(n, p_1) \in A) \le \mathbb P(G(n, p_1) \cup G(n, p_0) \in A) = \mathbb P(G(n, p_2)\in A)$

### 140. Придумайте такое свойство, что вероятность, что $G(n, \frac 12)$ обладает этим свойством, стремится к $\frac 14$.

Занумеруем все вершины графа. $G \in A \Leftrightarrow \exists v_1v_2, v_1v_3$.

### 141. Придумайте такое свойство, что вероятность, что $G(n, \frac 12)$ обладает этим свойством, стремится к $\frac 13$.

Вспомним прошлый семестр. Была задача получить вероятность $\dfrac{1}{3}$ из генератора с вероятностью $\dfrac{1}{2}$. Это решалось так:
> Да, пусть он кидает две монеты. Если $00$, он идет, если $10$ или $01$, не идет, если $11$, он все делает заново.

Используем вместо монет нумерованные ребра.

### 142. Пусть для некоторого свойства $A$ существует две функции $p_1(n)$ и $p_2(n)$, что для графа $G(n, p_1(n))$ свойство $A$ а.п.н. не выполняется, а для $G(n, p_2(n))$ свойство $A$ а.п.н. выполняется. Докажите, что существует функция $\tilde p(n)$, что для случайного графа $G(n, \tilde p(n))$ свойство $A$ выполняется с вероятностью, стремящейся к $\frac 12$.

Пусть $f : \mathcal F(\Z, [0, 1]) \to [0,1] : p \mapsto \lim\limits_{n\to+\infty}\mathbb P(G(n, p(n)) \in A)$.

Заметим, что $f$ непрерывно на $\mathcal F(\Z, [0, 1])$ и $\mathcal F(\Z, [0, 1])$ есть полное связное топологическое пространство, если использовать компактно-открытую топологию. Кроме того, $\exists p_1 : f(p_1) = 0, p_2 : f(p_2) = 1$

Тогда по теореме Больцано-Коши $\forall t\in [0, 1] \exists \tilde p : f(p) = t$, в частности для $t=1/2$.

### 143. Докажите, что $G(n, \frac {2\ln n}{n})$ а.п.н. не содержит вершин степени 0.

$$\begin{aligned}
    \mathbb P(\exists v : \deg v = 0) & = 1 - \mathbb P(\not \exists v : \deg v = 0) \\
    & = 1 - \prod_{v\in V} \mathbb P(\deg v \not = 0) \\
    & = 1 - \prod_{v\in V} (1 - \mathbb P(\deg v = 0)) \\
    & = 1 - \prod_{v\in V} (1 - (1 - p)^{n-1}) \\
    & = 1 - \prod_{v\in V} \left(1 - \left(1 - \frac{2\ln n}{n}\right)^{n-1}\right) \\
    & = 1 - \left(1 - \left(1 - \frac{2\ln n}{n}\right)^{n-1}\right)^n \to 0 \\
\end{aligned}$$

Стремление выполняется согласно вольфраму: `(1-(1-(2 ln (n)) / n)^(n-1))^n as n-> infty`
