## 13. Строки: хэши

### 13.1. Дана строка. После предподсчета за $\mathcal O(n)$, отвечать за $\mathcal O(1)$ на запрос: чему равна хеш-функция подстроки $s[l..r]$?

Посчитаем хеши всех префиксов. Тогда
$$\text{hash}(s[l .. r]) = \sum_{i=l}^{r} s[i] p^{i-l}$$
$$\text{hash}(s[l .. r]) \cdot p^l = \sum_{i=l}^{r} s[i] p^i = \text{hash}(s[0 .. r]) - \text{hash}(s[0 .. l])$$

### 13.2. Дана строка. Надо отвечать на запросы $lcp(i, j)$: длина наибольшего общего префикса строк $s[i..n]$ и $s[j..n]$. $\mathcal O(\log n)$ на запрос.

Запустим преподсчёт из 13.1. Запустим бинпоиск по длине префикса $l$ в поисках максимального $l : \text{hash}(s[i..i+l]) = \text{hash}(s[j..j+l])$.

### 13.3. Дана строка. Надо отвечать на запросы: является ли заданная подстрока палиндромом? $\mathcal O(\log n)$ на запрос.

Вроде как можно решить в $\mathcal O(1)$ на запрос. Запускаем 13.1 дважды - один раз прямой, другой обратный. Для каждого запроса проверяем, что в прямом и обратном порядке хэши одинаковы.

### 13.4. Дана строка. Надо отвечать на запросы: являются ли две заданные подстроки анаграммами? $\mathcal O(\log n)$ на запрос.

Пусть каждому символу сопоставляется простое число. Хэш строки - произведение всех её простых чисел. Очевидно коллизий нет с точностью до перестановки.

### 13.5. Число $p < |s|$ является периодом строки $s$, если для любого $i$ $s[i] = s[i+p]$. Дана строка. Найти все ее периоды. $\mathcal O(n)$.

### 13.6. Даны две строки. Найдите их наибольшую общую подстроку. $\mathcal O(n \log n)$.

### 13.7. Дана строка. Найти максимальную по длине строку, которая является ее префиксом, суффиксом, а так же встречается в середине строки. $\mathcal O(n \log n)$.

### 13.8. Дана строка. Обрабатывать два вида запросов: 1) изменить один символ 2) проверить что две подстроки равны. Оба запроса за $\mathcal O(\log n)$.

### 14.1

Посчитаем z-функцию. Если для $i$-го символа префикс-функция = $j$ и $i+j=n$, то $i$ - период.