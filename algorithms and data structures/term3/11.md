# 11. Кратчайшие пути и не только

### 11.1. Дан граф, на каждом ребре написано число. За один ход можно пройти несколько ребер, сумма чисел на которых не превышает $D$. Дойти от $s$ до $t$ за минимальное число ходов. $O(E \log V )$.

### 11.2. Есть сеть железных дорог, про каждую известно, сколько можно получить денег, если сдать ее на металлалом, нужно получить как можно больше, но чтобы города 1 и 2 были связаны.

Найдём минимальный путь $1\to2$, удалим все остальные дороги.

### 11.3. Петя перепутал и написал алгоритм Флойда так: `for i: for j: for k: d[i][j] = min(d[i][j], d[i][k] + d[k][j])`. Постройте тест, на котором получившийся алгоритм работает неверно.

### 11.4. Как найти все вершины, вес пути до которых может быть сколь угодно малым?

Найдём все достижимые из $s$ циклы, найдём среди них циклы с отрицательным весом. Найдём достижимые из этих циклов вершины.

### 11.5. Приведите пример графа, на котором алгоритм Форда–Беллмана делает Ω(V^3) успешных релаксаций.

### 11.6. Дан взвешенный неориентированный связанный граф, E − V ≤ 20. Вам нужно отвечать на запросы: найти кратчайшее расстояние между двумя заданными вершинами. Предподсчет за O(E log V ), ответ на запрос за O(1).

### 11.7. Модифицировать алгоритм Дейкстры, чтобы он работал за O(M + E), если все кратчайшие пути не больше M.

### 11.8. Дан граф, изначально веса ребер равны нулю. Есть операция: заданному множеству ребер увеличить вес на 1. Нужно после каждого изменения пересчитать расстояния от s до всех вершин за O(V + E).

### 11.9. Дан взвешенный граф. Удалить максимальное число ребер, при условии что расстояние от s до t должно быть не больше d.

### 11.10. Дано взвешенное дерево. Найдите расстояние между каждой парой вершин. Время O(n^2).

Мы знаем, что `bfs` умеет давать массив расстояний от фиксированной вершины до всех других. Запустим его для каждой из $n$ вершин, получим искомое.

```c
for v in V:
    dists = bfs(v)
    for u in V - v:
        d[v][u] = min(d[v][u], dists[u])
```

### 11.11. Сеть дорог представляет собой взвешенное дерево. В каждом городе продаются машины, в городе i можно купить машину, которая едет со скоростью vi . За какое минимальное время можно доехать из города A в город B? Время O(n^2).

### 11.12. Есть n планет и m телепортов. С помощью телепорта i можно попасть с планеты vi на любую из планет с номерами от li до ri . Найти кратчайший путь от планеты 1 до планеты n. Время O((n + m) log n).

### 11.13. Дан взвешенный неориентированный граф, веса ребер неотрицательные. Выделены три вершины. Выбрать подграф минимального веса, в котором эти вершины лежат в одной компоненте связности. Время O(E log V ).

### 11.14. То же задание для четырех выделенных вершин. Время O(E log V ).

### 11.15. Можно ли построить такой ориентированный граф, в котором одно и то же ребро лежит как на кратчайшем пути из v в u, так и на кратчайшем пути из u в v?

### 11.16. Дана матрица кратчайших расстояний между всеми парами вершин. Построить граф, которому она соответствует или сказать, что такого не существует.

### 11.17. Петя и Вася играют в игру. Дан граф, в котором выделена вершина s. Петя выбирает вершину t и строит какой-то реберно-простой путь из s в t. После этого Вася должен построить еще один реберно-простой путь из s в t, не пересекающийся по ребрам с путем Пети. Если он сможет это сделать, он выиграл, если нет — то выиграл Петя. Кто выиграет при правильной игре? (подсказка: посмотрите, кто выигрывает если граф Эйлеров)

### 11.18. Дано n чисел xi. Постройте ориентированный ацикличый граф из n вершин, в котором из вершины i достижимо ровно xi вершин (или скажите, что такого нет).